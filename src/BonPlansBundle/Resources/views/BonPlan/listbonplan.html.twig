{% extends 'front.html.twig' %}

{% block css %}
    <style>
        .divlm{
            display:none;
        }

    </style>
{% endblock %}

{% block content %}




    <div class="header-spacer header-spacer-small"></div>


<!-- Main Header BlogV1 -->

<div class="main-header">
    <div class="content-bg-wrap bg-account"></div>
    <div class="container">
        <div class="row">
            <div class="col col-lg-8 m-auto col-md-8 col-sm-12 col-12">
                <div class="main-header-content">
                    <h1>Les bons plans</h1>
                </div>
            </div>
        </div>
    </div>

    <img class="img-bottom" src="{{ asset('template/') }}img/blog_bottom.png" alt="friends">
</div>

<!-- ... end Main BlogV1 -->


<div class="container">
    <div class="row">
        <div class="col col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
            <div class="ui-block responsive-flex1200">
                <div class="ui-block-title">

                    <a href="{{ path('bon_plans_ajouter_bon_plan') }}" class="btn btn-primary">Ajouter Bon Plan</a>

                    <form method="post">
                    <div class="w-select">
                        <div class="title">Filtrer par:</div>
                        <fieldset class="form-group">
                            <select class="selectpicker form-control">
                                {% for c in categorie %}
                                <option value="" name="">{{ c.type }}</option>
                               {% endfor %}
                            </select>
                        </fieldset>
                        <button class="btn btn-primary btn-sm" type="submit">Filtrer</button>
                        <div class="input-group-btn">

                        </div>
                    </div>
                    </form>
                    {#<div class="w-select">#}
                        {#<fieldset class="form-group">#}
                            {#<select class="selectpicker form-control">#}
                                {#<option value="NU">Date (Descending)</option>#}
                                {#<option value="NU">Date (Ascending)</option>#}
                            {#</select>#}
                        {#</fieldset>#}
                    {#</div>#}

                    {#<a href="#" data-toggle="modal" data-target="#create-photo-album"></a>#}

                    <form class="w-search">
                        <div class="form-group with-button">
                            <input class="form-control js-user-search" type="text" placeholder="Rechercher un bon plan......">
                            <button>
                                <svg class="olymp-magnifying-glass-icon"><use xlink:href="{{ asset('template/') }}svg-icons/sprites/icons.svg#olymp-magnifying-glass-icon"></use></svg>
                            </button>
                        </div>

                        {#<div class="inline-items" id="entitiesNav">#}
                            {#Recherche #}
                        {#</div>#}
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="container">
    <div class="row">

        <div class="col col-xl-8 col-lg-8 col-md-12 col-sm-12 col-12">

            {% for b in bonsplans %}
            <div class="ui-block">


                <!-- Post -->

                <article class="hentry blog-post blog-post-v3">

                    <div class="post-thumb">
                        <img src="{{ asset('img/')}}{{ b.image }}" >
                        <a href="{{ path('bon_plan_detail',{'id':b.id}) }}" class="post-category bg-blue-light">{{ b.name }}</a>
                    </div>

                    <div class="post-content">

                        <div class="author-date">
                            Par
                            <a class="h6 post__author-name fn" href="{{ path('user_profil') }}">{{ b.user }}</a>
                            <div class="post__date">
                                <time class="published" datetime="2017-03-24T18:18">
                                    - {{ b.datePublication |date('d,m,y') }}
                                </time>
                            </div>
                        </div>

                        <a href="{{ path('bon_plan_detail',{'id':b.id}) }}" class="h3 post-title">
                           {{ b.name }}</a>
                        <p>{{ b.description }}
                        </p>

                        <div class="post-additional-info inline-items">

                            <ul class="friends-harmonic">
                                <li>
                                    <a href="#">
                                        <img src="{{ asset('template/') }}img/icon-chat27.png" alt="icon">
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <img src="{{ asset('template/') }}img/icon-chat2.png" alt="icon">
                                    </a>
                                </li>
                            </ul>
                            <div class="names-people-likes">
                                26
                            </div>

                            <div class="comments-shared">
                                <a href="#" class="post-add-icon inline-items">
                                    <svg class="olymp-speech-balloon-icon"><use xlink:href="{{ asset('template/') }}svg-icons/sprites/icons.svg#olymp-speech-balloon-icon"></use></svg>
                                    <span>0</span>
                                </a>
                            </div>

                        </div>
                    </div>


                </article>

                <!-- ... end Post -->

            </div>
            {% endfor %}
        </div>





        <div class="col col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12">
            <div class="ui-block">
                <div class="ui-block-title">
                    <h6 class="title">Les bons plans les plus not√©s</h6>
                </div>
                <div class="ui-block-content">


                    <!-- Widget Featured Topics -->

                    <ul class="widget w-featured-topics">
                        {% for m in bonsplansmax %}
                        <li>
                            <i class="icon fa fa-star" aria-hidden="true"></i>
                            <div class="content">
                                <a href="{{ path('bon_plan_detail',{'id':m.id}) }}" class="h6 title">{{ m.name }}</a>
                                <time class="entry-date updated" datetime="2017-06-24T18:18">{{ m.datePublication |date('d,m,y') }}</time>
                            </div>
                        </li>
                        {% endfor %}

                    </ul>

                    <!-- ... end Widget Featured Topics -->
                </div>
            </div>


        </div>
    </div>





            <!-- Pagination -->

            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">
                    <li class="page-item disabled">
                        <a class="page-link" href="#" tabindex="-1">Previous</a>
                    </li>
                    <li class="page-item"><a class="page-link" href="#">1<div class="ripple-container"><div class="ripple ripple-on ripple-out" style="left: -10.3833px; top: -16.8333px; background-color: rgb(255, 255, 255); transform: scale(16.7857);"></div></div></a></li>
                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                    <li class="page-item"><a class="page-link" href="#">...</a></li>
                    <li class="page-item"><a class="page-link" href="#">12</a></li>
                    <li class="page-item">
                        <a class="page-link" href="#">Next</a>
                    </li>
                </ul>
            </nav>

            <!-- ... end Pagination -->

        </div>



    </div>

</div>
    <script src="{{ asset('template/js/jquery-3.2.1.js') }}"></script>

    <script>

        $(document).ready(function () {
            var searchRequest = null;
            $(".js-user-search").keyup(function () {
                var minlength = 1;
                var that = this;
                var value = $(this).val();
                var entitySelector = $("#entitiesNav").html('');
                if (value.length >= minlength) {
                    if (searchRequest != null)
                        searchRequest.abort();
                    searchRequest = $.ajax({
                        type: "GET",
                        url: "{{ path('ajax_search') }}",
                        data: {
                            'q': value
                        },
                        dataType: "text",
                        success: function (msg) {
                            //we need to check if the value is the same
                            if (value == $(that).val()) {
                                var result = JSON.parse(msg);
                                $.each(result, function (key, arr) {
                                    $.each(arr, function (id, value) {
                                        if (key == 'entities') {
                                            if (id != 'error') {
                                                entitySelector.append('<li><a href="/Pi-Dev-Web/web/app_dev.php/user/' + id + '/compte">' +
                                                    ' <div class="autho"><img src="{{ asset('img/') }}' + value[3] + '" alt="avatar"></div>' +
                                                    '<div class="notification-event">' +
                                                    '<span class="h6 notification-friend"></a>' + value[0] + '</span>' + ' ' +
                                                    '<span class="chat-message-item">' + '<b>' + value[2] + '</b>' + '</span>' + '</br>' +
                                                    '<a href="/Pi-Dev-Web/web/app_dev.php/user/' +
                                                    '</div>\n' +
                                                    '<span class="notification-icon"><svg class="\' + escape(item.icon) + \'"><use xlink:href="icons/icons.svg#\' + escape(item.icon) + \'"></use></svg></span>' + '</a></li>');

                                            } else {
                                                entitySelector.append('<li class="errorLi">' + value + '</li>');
                                            }
                                        }
                                    });
                                });
                            }
                        }
                    });
                }
            });});
            </script>

{% endblock %}